---
title: 使用 VSCode 开发 Kotlin
date: 2026-01-24
tags: ['技术']
sitemap:
  lastmod: 2026-01-24
---

之前有些后端项目用的 Kotlin + Spring Boot，IDE 用的 IDEA 开发的。但是 IDEA 中的 GitHub Copilot 插件实在太弱智，打算换成 VSCode 来开发 Kotlin。

网上几乎没有教程（可能确实没人这么干），踩了不少坑，试了很多插件，花了快一天时间才终于搞好。

首先，需要安装 VSCode 的 [Java Extension Pack](https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-pack) 插件包，这个插件包包含了 Java 开发所需的各种插件。

然后，还需要安装 [kotlin-lsp](https://github.com/Kotlin/kotlin-lsp/releases) 插件，这个是 Kotlin 官方的插件，提供了 Kotlin 的语法高亮、格式化、跳转等功能。需要注意的是，这个插件尚未发布到 VSCode 市场，需要手动下载并安装。另外，该插件当前只支持 Gradle 项目，不支持 Maven 项目。如果是 Maven 项目，得转换成 Gradle 项目才能使用该插件。

VSCode 配置：

```json
{
  "[kotlin]": {
    "editor.defaultFormatter": "JetBrains.kotlin",
  },
}

另外，`kotlin-lsp` 插件暂不支持 `Gradle Kotlin DSL` （[Issue#55](https://github.com/Kotlin/kotlin-lsp/issues/55)）。

尝试了 `ktfmt`、`ktfmt-gradle`、`Spotless Gradle` 等插件，最终都因为各种原因放弃了。

另外还遇到一个 `kotlin-lsp` 的奇怪 bug，就是插件一直报错：

```log
Error while resolving org.jetbrains.kotlin.fir.declarations.impl.FirValueParameterImpl from SEALED_CLASS_INHERITORS to ANNOTATION_ARGUMENTS current declaration phase SEALED_CLASS_INHERITORS origin: Source session: class org.jetbrains.kotlin.analysis.low.level.api.fir.sessions.LLFirSourcesSession module data: class org.jetbrains.kotlin.analysis.low.level.api.fir.projectStructure.LLFirModuleData KaModule: class org.jetbrains.kotlin.idea.base.fir.projectStructure.modules.source.KaSourceModuleImpl platform: JVM (1.8)


WARNING: package sun.awt.windows not in java.desktop
WARNING: package sun.awt.X11 not in java.desktop
WARNING: package com.sun.java.swing.plaf.gtk not in java.desktop
2026-01-24 14:56:27,188 [      2]   INFO - #c.j.l.k.KotlinLspServerKt - The specified workspace data path is already in use: /Users/bean/Library/Application Support/Code/User/workspaceStorage/49b2c6504bda2f903cf8d056a8536e02/JetBrains.kotlin
2026-01-24 14:56:27,286 [    100]   INFO - #c.j.l.k.KotlinLspServerKt - idea.config.path=/var/folders/06/hrswn44j3t1gyf0tngx5qzbr0000gn/T/idea-system17158470989559084090/config
2026-01-24 14:56:27,286 [    100]   INFO - #c.j.l.k.KotlinLspServerKt - idea.system.path=/var/folders/06/hrswn44j3t1gyf0tngx5qzbr0000gn/T/idea-system17158470989559084090/system
2026-01-24 14:56:27,607 [      3] WARNING - #c.i.i.p.PluginManager - Plugin descriptor for plugin 'intellij.kotlin.searching.xml' has declared element 'visibility' which has no effect there
```

比较了两个文件夹，同样的代码，一个报错，一个不报错，报错的那个文件夹换个名字就好了。怀疑是缓存的问题，困扰了很久，最终找到了缓存位置：

```
/Users/bean/Library/Application Support/JetBrains/analyzer/workspaces/
```

删除该目录下的缓存文件夹，重启 VSCode 后问题解决。

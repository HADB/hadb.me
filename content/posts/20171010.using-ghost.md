---
title: å¼€å§‹ä½¿ç”¨Ghostå•¦ï¼
date: 2017-10-10
cover: jpg
tags: ['æ—¥å¿—', 'åšå®¢', 'Ghost']
---

å…³æ³¨Ghostå¾ˆä¹…å¾ˆä¹…äº†ï¼Œ14å¹´å°±å°è¯•è¿‡0.5.3ç‰ˆï¼Œç”±äºä¸€ç›´æ²¡æœ‰å‡ºæ­£å¼ç‰ˆï¼Œæ‰€ä»¥ä¸€ç›´å¤„äºå…³æ³¨å’Œç­‰å¾…ä¸­ã€‚

ç»ˆäºåœ¨å·®ä¸å¤šä¸€å¹´å‰Ghoståœ¨GitHubä¸Šå‘å¸ƒäº†[1.0.0-alpha.1](https://github.com/TryGhost/Ghost/releases/tag/1.0.0-alpha.1)ï¼Œæœ¬ä»¥ä¸ºå¾ˆå¿«å°±èƒ½å‡ºæ­£å¼ç‰ˆäº†ï¼Œå¼€å§‹äº†ç„¦æ€¥çš„ç­‰å¾…ã€‚ä¸€å¼€å§‹åŸºæœ¬ä¸Šæ¯å¤©éƒ½ä¼šå»GitHubä¸Šæ£€æŸ¥ä¸‹ä»–ä»¬çš„åŠ¨æ€ã€‚åæ¥å˜æˆäº†å¤§çº¦æ¯å‘¨ä¼šå»çœ‹ä¸€æ¬¡ï¼Œç­‰äº†ä¸€ä¸ªåˆä¸€ä¸ªç‰ˆæœ¬ï¼Œç”šè‡³ç­‰äº†å¤§åŠå¹´ï¼Œç»ˆäºåœ¨ç¬¬21ä¸ªalphaç‰ˆåï¼Œæ¨å‡ºäº†betaç‰ˆï¼Œéšåä¸ä¹…å‘å¸ƒäº†1.0.0æ­£å¼ç‰ˆã€‚å°è¯•å»å®‰è£…ï¼Œç»“æœå‘ç°æŒºå¤šå‘çš„ï¼Œè¯•äº†å¾ˆä¹…éƒ½æ²¡æˆåŠŸï¼Œæ­£å¼ç‰ˆçš„Dockeré•œåƒä¹Ÿä¸€ç›´æ²¡å‡ºã€‚å†åé¢ï¼ŒGhostå›¢é˜Ÿçš„æ›´æ–°ä¹Ÿéå¸¸å‹¤å¥‹ï¼ŒåŸºæœ¬æ¯å‘¨éƒ½ä¼šå‘å¸ƒæ–°ç‰ˆæœ¬ï¼Œé‚£æ®µæœŸé—´æˆ‘æ­£å¥½ä¹Ÿæ¯”è¾ƒå¿™ï¼Œä¸€ç›´åœ¨é»˜é»˜å…³æ³¨ï¼Œæ²¡æœ‰å†å»å°è¯•å®‰è£…ï¼Œä»»åŠ¡åˆ—è¡¨é‡Œçš„â€œåšå®¢è¿ç§»åˆ°Ghostä¸Šâ€ä¹Ÿè¢«ä¸€å†æ¨è¿Ÿã€‚

ç›´åˆ°ä»Šå¤©ï¼Œçªç„¶æƒ³å†å»è¯•ä¸‹ã€‚çœ‹åˆ°Dockeré•œåƒä¹ŸåŒæ­¥äº†æœ€æ–°çš„ç‰ˆæœ¬ï¼Œäºæ˜¯ç›´æ¥ä¸ŠDockerã€‚å‡ åˆ†é’Ÿå°±è£…å®Œäº†ï¼Œå¦‚ä¸èˆ¬é¡ºæ»‘ï¼Œå¾ˆçˆ½ï¼ï¼ˆ20171012æ›´æ–°ï¼šé€šè¿‡é»˜è®¤å‘½ä»¤å®‰è£…ï¼Œæœ‰äº›åœ°å€ä¼šæ˜¾ç¤ºæˆlocalhostå¼€å¤´çš„åœ°å€ï¼Œé€šè¿‡`--env url=https://hadb.me/`å¯ä»¥ä¿®æ”¹è¿™ä¸ªåœ°å€ï¼Œä½†æ˜¯ç”±äºNginxè®¾ç½®æœ‰é—®é¢˜ï¼Œå¯¼è‡´è®¾ç½®æˆhttpsçš„åœ°å€åå°±é™·å…¥é‡å®šå‘å¾ªç¯ï¼Œè¿™ä¸ªé—®é¢˜åæ¥å›°æ‰°äº†å¾ˆä¹…ï¼Œè§£å†³æ–¹æ¡ˆä¸‹é¢ä¼šè®²ã€‚ï¼‰

ä½œä¸ºä¸€ä¸ªæŠ€æœ¯åšä¸»ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯æœ‰å¿…è¦æŠŠå®‰è£…æ­¥éª¤å†™ä¸€ä¸‹ï¼Œæ–¹ä¾¿åäººã€‚

æˆ‘çš„åšå®¢æ˜¯æ­å»ºåœ¨è‡ªå·±å®¶é‡Œçš„NASæœåŠ¡å™¨ä¸Šï¼Œå…·ä½“ç»†èŠ‚ä»¥åå†è®²ã€‚

### å®¿ä¸»æœºå®‰è£…è¯ä¹¦
```bash
service nginx stop && \
certbot certonly --standalone --preferred-challenges tls-sni -d hadb.me && \
service nginx start
```

### å®¿ä¸»æœºNginxè®¾ç½®
```nginx
server {
    listen 443 ssl;
    server_name hadb.me;
    client_max_body_size 1024m;
    ssl on;
    ssl_certificate /etc/letsencrypt/live/hadb.me/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/hadb.me/privkey.pem;
    location / {
        proxy_redirect off;
        proxy_read_timeout 300;
        proxy_set_header host $host;
        proxy_set_header x-real-ip $remote_addr;
        proxy_set_header x-forwarded-for $proxy_add_x_forwarded_for;
        proxy_set_header x-forwarded-proto https;
        proxy_pass http://localhost:12368;
    }
}
```

å…¶ä¸­ `proxy_set_header x-forwarded-proto https;`å¾ˆé‡è¦ï¼Œå¦‚æœä¸åŠ çš„è¯ï¼Œå½“å¯åŠ¨dockerè®¾ç½®urlä¸ºhttpså¼€å¤´çš„åœ°å€æ—¶ï¼Œå°±ä¼šé™·å…¥é‡å®šå‘å¾ªç¯ï¼Œè¿™ä¸ªé—®é¢˜å›°æ‰°äº†æˆ‘å¾ˆä¹…ï¼Œæœ€ç»ˆåœ¨[è¿™ä¸ªissue](https://github.com/TryGhost/Ghost/issues/2796)é‡Œæ‰¾åˆ°äº†ç­”æ¡ˆã€‚

### åˆ›å»ºæ•°æ®é•œåƒ
```bash
docker create -v /srv/ghost/hadb.me:/var/lib/ghost/content --name ghost-hadb-me-data ubuntu:16.04
```

### å¯åŠ¨docker
```bash
sudo docker run --detach \
    --name ghost-hadb-me \
    --env url=https://hadb.me/ \
    --publish 12368:2368 \
    --volumes-from ghost-hadb-me-data \
    --tty \
    ghost:latest
```

å‡ è¡Œå‘½ä»¤ï¼ŒDoneï¼å°±å¯ä»¥å¼€å§‹æ„‰å¿«çš„å†™åšå®¢å•¦ï¼å“ˆå“ˆå“ˆå“ˆå“ˆï¼ğŸ˜ƒ
